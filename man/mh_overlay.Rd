% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mh_overlay.R
\name{mh_overlay}
\alias{mh_overlay}
\title{Overlay Mahalanobis-based Climate Representativeness Change Classifications}
\usage{
mh_overlay(
  folder_path,
  output_filename = "combined_category_counts.tif",
  category_values = c(1, 2, 3),
  add_to_environment = FALSE
)
}
\arguments{
\item{folder_path}{Character. Path to the directory containing the input single-layer GeoTIFF
classification rasters (e.g., outputs from \code{mh_rep_ch}).}

\item{output_filename}{Character. The name for the output combined multi-layered GeoTIFF file.
The file will be saved within the \code{folder_path}. Defaults to "combined_category_counts_ap.tif".}

\item{category_values}{Numeric vector. A vector specifying the specific pixel
values (\code{c(0, 1, 2, 3)}) to count in the input categories:
0 = Non-representativeness,
1 = Represented (mh_rep) or Retained (mh_rep_ch),
2 = Lost (mh_rep_ch),
3 = Novel (mh_rep_ch)). Defaults to \code{c(1, 2, 3)}.}

\item{add_to_environment}{Logical. If TRUE, the resulting multi-layered \code{SpatRaster}
object is assigned to a variable named \code{climarep_img} in the calling R environment.
Defaults to \code{FALSE}.}
}
\value{
Invisibly returns the resulting multi-layered \code{SpatRaster} object.
Writes the output stack to a GeoTIFF file in the specified \code{folder_path}.
If \code{add_to_environment} is TRUE, also assigns the stack to \code{climarep_img} in the parent environment.
}
\description{
Combines multiple single-layer GeoTIFF rasters, typically outputs from \code{mh_rep_ch}
for different input polygons, into a single multi-layered raster. Each layer
in the output stack represents the count of how many input rasters had a
specific category value (e.g., Persistence, Loss, Gain) at each grid cell.
This allows visualizing spatial agreement or accumulation of change types across regions.
}
\details{
This function is intended to be used after running \code{mh_rep} or \code{mh_rep_ch} for multiple
input polygons. Each run of \code{mh_rep_ch} produces a classification raster
(e.g., codes 0, 1, 2, 3) for a single polygon. \code{mh_overlay} takes these
individual polygon outputs and aggregates them by category.

For each cell in the study area and for each specified \code{category_value}, the
function counts how many of the input classification rasters assigned that
specific \code{category_value} to that cell. The output is a stack where each
layer represents the counts for one category.
}
\examples{
\dontrun{
folder_path <- tempdir()
mh_overlay(folder_path,
  output_filename = "combined_category_counts.tif",
  category_values = c(1, 2, 3),
  add_to_environment = TRUE)
terra::plot(climarep_img)
}
}
