% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mh_rep_ch.R
\name{mh_rep_ch}
\alias{mh_rep_ch}
\title{Multivariate Temporal Climate Representativeness Change Analysis}
\usage{
mh_rep_ch(
  polygon,
  col_name,
  present_climatic_variables,
  future_climatic_variables,
  study_area,
  th = 0.9,
  model,
  year,
  dir_output = "output/",
  save_intermediate_raster = TRUE
)
}
\arguments{
\item{polygon}{An sf object containing the analysis regions (input polygons).}

\item{col_name}{Character. Name of the column in the \code{polygon} object that contains unique identifiers for each input polygon.}

\item{present_climatic_variables}{SpatRaster. A raster stack of climate variables representing present conditions (preferably not strongly correlated).}

\item{future_climatic_variables}{SpatRaster. A raster stack containing the \emph{same} climate variables as \code{present_climatic_variables} but representing future projected conditions. Must have the same extent and resolution as \code{present_climatic_variables}.}

\item{study_area}{sf object. A single polygon defining the overall boundary of the study area. Used to define the extent for overall climate variability calculation and output rasters.}

\item{th}{Numeric (0-1). Quantile threshold used to define representativeness based on Mahalanobis distance. Cells with a Mahalanobis distance below or equal to the distance corresponding to this quantile (calculated from distances \emph{within} the present polygon) are classified as representative (default: 0.9).}

\item{model}{Character. Name or identifier of the climate model used for future projections (e.g., "MIROC6"). This parameter is mandatory and used in output filenames and subdirectory names.}

\item{year}{Character. Projection year or period for future climate data (e.g., "2070"). This parameter is mandatory and used in output filenames and subdirectory names.}

\item{dir_output}{Character. Path to the directory where output files will be saved. The function will create subdirectories within this path (default: "output/").}

\item{save_intermediate_raster}{Logical. If TRUE, saves intermediate continuous Mahalanobis distance rasters for both present and future periods within the study area extent. The final classification rasters listed in \verb{@return} are saved regardless of this parameter setting (default: TRUE).}
}
\value{
Invisibly returns NULL. Writes the following outputs to disk within subdirectories of \code{dir_output}:
\itemize{
\item Classification Change Raster: A GeoTIFF raster showing the change category for each input polygon (e.g., codes 0, 1, 2, 3) is saved in the \verb{Change/} subdirectory. The categories typically represent: 0 - Not Representative in either period; 1 - Persistence (Representative in both); 2 - Loss (Representative Present, Not Future); 3 - Gain (Not Representative Present, Representative Future).
\item Visualization Maps: JPEG (or PNG) image files visualizing the change classification results for each input polygon are saved in the \verb{Charts/} subdirectory.
\item Intermediate Raw Mahalanobis Distance Rasters: \emph{Optionally} saved as GeoTIFF files if \code{save_intermediate_raster = TRUE}. The raw present distances (relative to the present polygon mean, scaled by overall variance) are saved in \verb{Mh_Raw_Pre/}. The raw future distances (relative to the present polygon mean, scaled by overall variance) are saved in \verb{Mh_Raw_Fut/}.
}
}
\description{
Calculates Mahalanobis-based climatic representativeness for input polygons across two time periods (present and future) within a defined study area. The function identifies areas of climate representativeness persistence, loss, or gain. Representativeness is assessed by comparing the multivariate climate conditions of each cell to the reference climate space defined by the climate conditions \emph{within} each specific input polygon in the \emph{present} period, scaled by the overall climate variability across both time periods within the study area.
}
\details{

}
